(function(f){"use strict";f.maxmegamenu=function(a,e){var u=this;var d=f(a);var h=d.siblings(".mega-menu-toggle");var n;var t={event:d.attr("data-event"),effect:d.attr("data-effect"),effect_speed:parseInt(d.attr("data-effect-speed")),effect_mobile:d.attr("data-effect-mobile"),effect_speed_mobile:parseInt(d.attr("data-effect-speed-mobile")),panel_width:d.attr("data-panel-width"),panel_inner_width:d.attr("data-panel-inner-width"),mobile_force_width:d.attr("data-mobile-force-width"),mobile_overlay:d.attr("data-mobile-overlay"),mobile_state:d.attr("data-mobile-state"),second_click:d.attr("data-second-click"),vertical_behaviour:d.attr("data-vertical-behaviour"),document_click:d.attr("data-document-click"),breakpoint:d.attr("data-breakpoint"),unbind_events:d.attr("data-unbind"),hover_intent_timeout:d.attr("data-hover-intent-timeout"),hover_intent_interval:d.attr("data-hover-intent-interval")};u.settings={};var c=f("li.mega-menu-megamenu.mega-menu-item-has-children,"+"li.mega-menu-flyout.mega-menu-item-has-children,"+"li.mega-menu-tabbed > ul.mega-sub-menu > li.mega-menu-item-has-children,"+"li.mega-menu-flyout li.mega-menu-item-has-children",a);var i=f("li.mega-menu-megamenu li.mega-menu-item-has-children.mega-collapse-children > a.mega-menu-link",a);u.addAnimatingClass=function(e){if(u.settings.effect==="disabled"){return}f(".mega-animating").removeClass("mega-animating");var n=u.settings.effect_speed+parseInt(megamenu.timeout,10);e.addClass("mega-animating");setTimeout(function(){e.removeClass("mega-animating")},n)};u.hideAllPanels=function(){f(".mega-toggle-on > a.mega-menu-link",d).each(function(){u.hidePanel(f(this),false)})};u.expandMobileSubMenus=function(){f(".mega-menu-item-has-children.mega-expand-on-mobile > a.mega-menu-link",d).each(function(){u.showPanel(f(this))});if(u.settings.mobile_state=="expand_all"){f(".mega-menu-item-has-children > a.mega-menu-link",d).each(function(){u.showPanel(f(this))})}if(u.settings.mobile_state=="expand_active"){f("li.mega-current-menu-ancestor.mega-menu-item-has-children > a.mega-menu-link,"+"li.mega-current-menu-item.mega-menu-item-has-children > a.mega-menu-link"+"li.mega-current-menu-parent.mega-menu-item-has-children > a.mega-menu-link"+"li.mega-current_page_ancestor.mega-menu-item-has-children > a.mega-menu-link"+"li.mega-current_page_item.mega-menu-item-has-children > a.mega-menu-link",d).each(function(){u.showPanel(f(this))})}};u.hideSiblingPanels=function(e,n){e.parent().parent().find(".mega-toggle-on").children("a.mega-menu-link").each(function(){u.hidePanel(f(this),n)})};u.isDesktopView=function(){return Math.max(window.outerWidth,f(window).width())>u.settings.breakpoint};u.isMobileView=function(){return!u.isDesktopView()};u.showPanel=function(e){e.parent().triggerHandler("before_open_panel");e.attr("aria-expanded","true");f(".mega-animating").removeClass("mega-animating");if(u.isMobileView()&&e.parent().hasClass("mega-hide-sub-menu-on-mobile")){return}if(u.isDesktopView()&&(d.hasClass("mega-menu-horizontal")||d.hasClass("mega-menu-vertical"))&&!e.parent().hasClass("mega-collapse-children")){u.hideSiblingPanels(e,true)}if(u.isMobileView()&&d.hasClass("mega-keyboard-navigation")||u.settings.vertical_behaviour==="accordion"){u.hideSiblingPanels(e,false)}u.calculateDynamicSubmenuWidths(e);if(e.parent().hasClass("mega-collapse-children")||u.settings.effect==="slide"||u.isMobileView()&&(u.settings.effect_mobile==="slide"||u.settings.effect_mobile==="slide_left"||u.settings.effect_mobile==="slide_right")){var n=u.isMobileView()?u.settings.effect_speed_mobile:u.settings.effect_speed;e.siblings(".mega-sub-menu").css("display","none").animate({height:"show",paddingTop:"show",paddingBottom:"show",minHeight:"show"},n,function(){f(this).css("display","")})}e.parent().addClass("mega-toggle-on").triggerHandler("open_panel")};u.hidePanel=function(e,n){e.parent().triggerHandler("before_close_panel");e.attr("aria-expanded","false");if(e.parent().hasClass("mega-collapse-children")||!n&&u.settings.effect==="slide"||u.isMobileView()&&(u.settings.effect_mobile==="slide"||u.settings.effect_mobile==="slide_left"||u.settings.effect_mobile==="slide_right")){var a=u.isMobileView()?u.settings.effect_speed_mobile:u.settings.effect_speed;e.siblings(".mega-sub-menu").animate({height:"hide",paddingTop:"hide",paddingBottom:"hide",minHeight:"hide"},a,function(){e.siblings(".mega-sub-menu").css("display","");e.parent().removeClass("mega-toggle-on").triggerHandler("close_panel")});return}if(n){e.siblings(".mega-sub-menu").css("display","none").delay(u.settings.effect_speed).queue(function(){f(this).css("display","").dequeue()})}e.siblings(".mega-sub-menu").find(".widget_media_video video").each(function(){this.player.pause()});e.parent().removeClass("mega-toggle-on").triggerHandler("close_panel");u.addAnimatingClass(e.parent())};u.calculateDynamicSubmenuWidths=function(e){if(e.parent().hasClass("mega-menu-megamenu")&&e.parent().parent().hasClass("max-mega-menu")&&u.settings.panel_width&&f(u.settings.panel_width).length>0){if(u.isDesktopView()){var n=d.offset();var a=f(u.settings.panel_width).offset();e.siblings(".mega-sub-menu").css({width:f(u.settings.panel_width).outerWidth(),left:a.left-n.left+"px"})}else{e.siblings(".mega-sub-menu").css({width:"",left:""})}}if(e.parent().hasClass("mega-menu-megamenu")&&e.parent().parent().hasClass("max-mega-menu")&&u.settings.panel_inner_width&&f(u.settings.panel_inner_width).length>0){var t=0;if(f(u.settings.panel_inner_width).length){t=parseInt(f(u.settings.panel_inner_width).width(),10)}else{t=parseInt(u.settings.panel_inner_width,10)}var i=parseInt(e.siblings(".mega-sub-menu").innerWidth(),10);if(u.isDesktopView()&&t>0&&t<i){e.siblings(".mega-sub-menu").css({paddingLeft:(i-t)/2+"px",paddingRight:(i-t)/2+"px"})}else{e.siblings(".mega-sub-menu").css({paddingLeft:"",paddingRight:""})}}};u.bindClickEvents=function(){var n=false;f(document).on({touchmove:function(e){n=true},touchstart:function(e){n=false}});f(document).on("click touchend",function(e){if(!n&&u.settings.document_click==="collapse"&&!f(e.target).closest(".max-mega-menu li").length&&!f(e.target).closest(".mega-menu-toggle").length){u.hideAllPanels();u.hideMobileMenu()}n=false});var e=f("> a.mega-menu-link",c).add(i);e.on("touchend.megamenu",function(e){u.unbindHoverEvents();u.unbindHoverIntentEvents()});e.not("[data-has-click-event]").on("click.megamenu",function(e){if(u.isDesktopView()&&f(this).parent().hasClass("mega-toggle-on")&&f(this).parent().parent().parent().hasClass("mega-menu-tabbed")){if(u.settings.second_click==="go"){return}else{e.preventDefault();return}}if(n){return}if(u.isMobileView()&&f(this).parent().hasClass("mega-hide-sub-menu-on-mobile")){return}if((u.settings.second_click==="go"||f(this).parent().hasClass("mega-click-click-go"))&&f(this).attr("href")!==undefined){if(!f(this).parent().hasClass("mega-toggle-on")){e.preventDefault();u.showPanel(f(this))}}else{e.preventDefault();if(f(this).parent().hasClass("mega-toggle-on")){u.hidePanel(f(this),false)}else{u.showPanel(f(this))}}});i.each(function(){f(this).attr("data-has-click-event","true")});if(u.settings.second_click==="disabled"){e.off("click.megamenu")}f(".mega-close-after-click:not(.mega-menu-item-has-children) > a.mega-menu-link",a).on("click",function(){u.hideAllPanels();u.hideMobileMenu()})};u.bindHoverEvents=function(){c.on({"mouseenter.megamenu":function(){u.unbindClickEvents();if(!f(this).hasClass("mega-toggle-on")){u.showPanel(f(this).children("a.mega-menu-link"))}},"mouseleave.megamenu":function(){if(f(this).hasClass("mega-toggle-on")&&!f(this).hasClass("mega-disable-collapse")&&!f(this).parent().parent().hasClass("mega-menu-tabbed")){u.hidePanel(f(this).children("a.mega-menu-link"),false)}}})};u.bindHoverIntentEvents=function(){c.hoverIntent({over:function(){u.unbindClickEvents();if(!f(this).hasClass("mega-toggle-on")){u.showPanel(f(this).children("a.mega-menu-link"))}},out:function(){if(f(this).hasClass("mega-toggle-on")&&!f(this).hasClass("mega-disable-collapse")&&!f(this).parent().parent().hasClass("mega-menu-tabbed")){u.hidePanel(f(this).children("a.mega-menu-link"),false)}},timeout:u.settings.hover_intent_timeout,interval:u.settings.hover_intent_interval})};u.bindKeyboardEvents=function(){var l=9;var o=27;var m=13;var g=37;var r=39;var t=32;d.parent().on("keyup.megamenu",function(e){var n=e.keyCode||e.which;if(n===l){d.parent().addClass("mega-keyboard-navigation")}});d.parent().on("keydown.megamenu",function(e){var n=e.keyCode||e.which;var a=f(e.target);if(n===t&&a.is(".mega-menu-link")&&d.parent().hasClass("mega-keyboard-navigation")){e.preventDefault();if(a.parent().is(c)){if(a.parent().hasClass("mega-toggle-on")&&!a.parent().parent().parent().hasClass("mega-menu-tabbed")){u.hidePanel(a)}else{u.showPanel(a)}}}});d.parent().on("keyup.megamenu",function(e){var n=e.keyCode||e.which;var a=f(e.target);if(n===l&&d.parent().hasClass("mega-keyboard-navigation")){if(a.parent().is(c)&&a.is("[href]")!==false){u.showPanel(a)}else{if(!a.parent().parent().parent().hasClass("mega-menu-tabbed")){u.hideSiblingPanels(a)}}}if(n===o&&d.parent().hasClass("mega-keyboard-navigation")){var t=f("> .mega-toggle-on",d).length!==0;f("> .mega-toggle-on > a.mega-menu-link",d).focus();u.hideAllPanels();if(u.isMobileView()&&!t){u.hideMobileMenu();f(".mega-menu-toggle-block, button.mega-toggle-animated",h).first().focus()}}if(n===m&&d.parent().hasClass("mega-keyboard-navigation")){if(a.hasClass("mega-menu-toggle-block")){if(h.hasClass("mega-menu-open")){u.hideMobileMenu()}else{u.showMobileMenu()}}if(a.parent().is(c)&&a.is("[href]")===false){if(a.parent().hasClass("mega-toggle-on")&&!a.parent().parent().parent().hasClass("mega-menu-tabbed")){u.hidePanel(a)}else{u.showPanel(a)}}}if(n===r&&u.isDesktopView()&&d.parent().hasClass("mega-keyboard-navigation")&&d.hasClass("mega-menu-horizontal")){var i=f("> .mega-toggle-on",d).nextAll("li.mega-menu-item:visible").find("> a.mega-menu-link, .mega-search input[type=text]").first();if(i.length===0){i=f(":focus",d).parent().nextAll("li.mega-menu-item:visible").find("> a.mega-menu-link, .mega-search input[type=text]").first()}i.focus();if(i.parent().is(c)&&i.is("[href]")!==false){u.showPanel(i)}else{u.hideSiblingPanels(i)}}if(n===g&&u.isDesktopView()&&d.parent().hasClass("mega-keyboard-navigation")&&d.hasClass("mega-menu-horizontal")){var s=f("> .mega-toggle-on",d).prevAll("li.mega-menu-item:visible").find("> a.mega-menu-link, .mega-search input[type=text]").last();if(s.length===0){s=f(":focus",d).parent().prevAll("li.mega-menu-item:visible").find("> a.mega-menu-link, .mega-search input[type=text]").last()}s.focus();if(s.parent().is(c)&&s.is("[href]")!==false){u.showPanel(s)}else{u.hideSiblingPanels(s)}}});d.parent().on("focusout.megamenu",function(e){if(d.parent().hasClass("mega-keyboard-navigation")){setTimeout(function(){var e=d.parent().find(":focus").length>0;if(!e){d.parent().removeClass("mega-keyboard-navigation");u.hideAllPanels();u.hideMobileMenu()}},10)}})};u.unbindAllEvents=function(){f("ul.mega-sub-menu, li.mega-menu-item, li.mega-menu-row, li.mega-menu-column, a.mega-menu-link, span.mega-indicator",a).off().unbind()};u.unbindClickEvents=function(){f("> a.mega-menu-link",c).not(i).off("click.megamenu touchend.megamenu")};u.unbindHoverEvents=function(){c.unbind("mouseenter.megamenu mouseleave.megamenu")};u.unbindHoverIntentEvents=function(){c.unbind("mouseenter mouseleave").removeProp("hoverIntent_t").removeProp("hoverIntent_s")};u.unbindKeyboardEvents=function(){d.parent().off("keyup.megamenu keydown.megamenu focusout.megamenu")};u.unbindMegaMenuEvents=function(){if(u.settings.event==="hover_intent"){u.unbindHoverIntentEvents()}if(u.settings.event==="hover"){u.unbindHoverEvents()}u.unbindClickEvents();u.unbindKeyboardEvents()};u.bindMegaMenuEvents=function(){u.unbindMegaMenuEvents();if(u.isDesktopView()&&u.settings.event==="hover_intent"){u.bindHoverIntentEvents()}if(u.isDesktopView()&&u.settings.event==="hover"){u.bindHoverEvents()}u.bindClickEvents();u.bindKeyboardEvents()};u.checkWidth=function(){if(u.isMobileView()&&d.data("view")==="desktop"){u.switchToMobile()}if(u.isDesktopView()&&d.data("view")==="mobile"){u.switchToDesktop()}u.calculateDynamicSubmenuWidths(f("> li.mega-menu-megamenu > a.mega-menu-link",d))};u.reverseRightAlignedItems=function(){if(!f("body").hasClass("rtl")&&d.hasClass("mega-menu-horizontal")){d.append(d.children("li.mega-item-align-right").get().reverse())}};u.addClearClassesToMobileItems=function(){f(".mega-menu-row",d).each(function(){f("> .mega-sub-menu > .mega-menu-column:not(.mega-hide-on-mobile)",f(this)).filter(":even").addClass("mega-menu-clear")})};u.initDesktop=function(){d.data("view","desktop");u.bindMegaMenuEvents();u.initIndicators()};u.switchToDesktop=function(){d.data("view","desktop");u.bindMegaMenuEvents();u.reverseRightAlignedItems();u.hideAllPanels();u.hideMobileMenu(true)};u.initMobile=function(){u.switchToMobile()};u.switchToMobile=function(){d.data("view","mobile");u.bindMegaMenuEvents();u.initIndicators();u.reverseRightAlignedItems();u.addClearClassesToMobileItems();u.hideAllPanels();u.expandMobileSubMenus()};u.initToggleBar=function(){h.on("click",function(e){if(f(e.target).is(".mega-menu-toggle, .mega-menu-toggle-custom-block *, .mega-menu-toggle-block, .mega-menu-toggle-animated-block, .mega-menu-toggle-animated-block *, .mega-toggle-blocks-left, .mega-toggle-blocks-center, .mega-toggle-blocks-right, .mega-toggle-label, .mega-toggle-label span")){e.preventDefault();if(f(this).hasClass("mega-menu-open")){u.hideMobileMenu()}else{u.showMobileMenu()}}})};u.initIndicators=function(){f("span.mega-indicator",d).not("[data-has-click-event]").on("click.megamenu",function(e){e.preventDefault();e.stopPropagation();if(f(this).parent().parent().hasClass("mega-toggle-on")){if(!f(this).parent().parent().parent().parent().hasClass("mega-menu-tabbed")||u.isMobileView()){u.hidePanel(f(this).parent(),false)}}else{u.showPanel(f(this).parent(),false)}});f("span.mega-indicator",d).each(function(){f(this).attr("data-has-click-event","true")})};u.hideMobileMenu=function(e){e=e||false;if(!h.is(":visible")&&!e){return}n=setTimeout(function(){f("body").removeClass(d.attr("id")+"-mobile-open");f("html").removeClass(d.attr("id")+"-off-canvas-open")},u.settings.effect_speed_mobile);f(".mega-toggle-label, .mega-toggle-animated",h).attr("aria-expanded","false");if(u.settings.effect_mobile==="slide"&&!e){d.animate({height:"hide"},u.settings.effect_speed_mobile,function(){d.css({width:"",left:"",display:""})})}d.css({width:"",left:"",display:""});h.removeClass("mega-menu-open");d.triggerHandler("mmm:hideMobileMenu")};u.showMobileMenu=function(){if(!h.is(":visible")){return}clearTimeout(n);f("body").addClass(d.attr("id")+"-mobile-open");u.expandMobileSubMenus();if(u.settings.effect_mobile==="slide_left"||u.settings.effect_mobile==="slide_right"){f("html").addClass(d.attr("id")+"-off-canvas-open")}f(".mega-toggle-label, .mega-toggle-animated",h).attr("aria-expanded","true");if(u.settings.effect_mobile==="slide"){d.animate({height:"show"},u.settings.effect_speed_mobile)}h.addClass("mega-menu-open");u.toggleBarForceWidth();d.triggerHandler("mmm:showMobileMenu")};u.toggleBarForceWidth=function(){if(f(u.settings.mobile_force_width).length&&(u.settings.effect_mobile==="slide"||u.settings.effect_mobile==="disabled")){var e=h.offset();var n=f(u.settings.mobile_force_width).offset();d.css({width:f(u.settings.mobile_force_width).outerWidth(),left:n.left-e.left+"px"})}};u.init=function(){d.triggerHandler("before_mega_menu_init");u.settings=f.extend({},t,e);d.removeClass("mega-no-js");u.initToggleBar();if(u.settings.unbind_events==="true"){u.unbindAllEvents()}f(window).on("load",function(){u.calculateDynamicSubmenuWidths(f("> li.mega-menu-megamenu > a.mega-menu-link",d))});if(u.isDesktopView()){u.initDesktop()}else{u.initMobile()}f(window).resize(function(){u.checkWidth()});d.triggerHandler("after_mega_menu_init")};u.init()};f.fn.maxmegamenu=function(n){return this.each(function(){if(undefined===f(this).data("maxmegamenu")){var e=new f.maxmegamenu(this,n);f(this).data("maxmegamenu",e)}})};f(function(){f(".max-mega-menu").maxmegamenu()})})(jQuery);